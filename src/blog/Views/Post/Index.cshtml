@model PostViewModel
@inject IOptions<BlogOption> Config
@{
    ViewData["Title"] = Model.Current.Raw.Title;
    ViewData["Image"] = Model.Current.ThumbnailImageUrl;
    ViewData["DatePublished"] = Model.Current.Raw.PublishTime;
    ViewData["DateModified"] = Model.Current.Raw.LastUpdateTime;
}

<div>
    <div class="mb-3">
        <div class="text-muted fs-sm">@Html.Raw(Model.MetadataHtml)</div>
        <h2 class="mb-3">
            <span>
                @Model.Current.Raw.Title

            </span>
            @if (Model.Current.Raw.IsTopping)
            {
                <span class="badge bg-success fs-sm">置顶</span>
            }

            @if (!Model.Current.Raw.IsPublished)
            {
                <span class="badge bg-warning fs-sm">
                    未发布
                </span>
            }
        </h2>
    </div>
    <div class="post-content">
        @Html.Raw(Model.Current.HtmlContent)
        <p class="text-muted">（本文完）</p>
    </div>

    <div class="alert alert-warning post-alert fs-sm" role="alert">
        <ul>
            <li>最后更新于：<span title="@Model.Current.Raw.LastUpdateTime.ToChinaDateAndTime()">@Model.Current.Raw.PublishTime.ToChinaDate()</span></li>
            @{
                var html = Model.TagHtml;
                if (!string.IsNullOrEmpty(html))
                {
                    <li>@Html.Raw(html)</li>
                }
            }

            @if (Model.Previous != null)
            {
                <li>前一篇：<a href="@Model.Previous.Raw.GetFullPath(Config.Value.BlogRemoteEndpoint)" class="text-decoration-none">@Model.Previous.Raw.Title</a></li>
            }

            @if (Model.Next != null)
            {
                <li>后一篇：<a href="@Model.Next.Raw.GetFullPath(Config.Value.BlogRemoteEndpoint)" class="text-decoration-none">@Model.Next.Raw.Title</a></li>
            }
            <li>
                文章的留言，请发送电子邮件至
                <a href="mailto:@Config.Value.AdminEmail?subject=RE:@Model.Current.Raw.Title&body=Good job！" class="text-decoration-none">
                    @Config.Value.AdminEmail
                </a>
            </li>
        </ul>
    </div>
</div>

@section Script {
    <script>
        hljs.highlightAll();
    </script>
    @if (Model.Current.Raw.ContainsMath)
    {
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    }
}