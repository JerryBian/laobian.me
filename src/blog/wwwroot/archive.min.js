!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof module&&module.exports?module.exports=factory():(root.AnchorJS=factory(),root.anchors=new root.AnchorJS)}(this,function(){"use strict";return function(options){function _applyRemainingDefaultOptions(opts){opts.icon=Object.prototype.hasOwnProperty.call(opts,"icon")?opts.icon:"",opts.visible=Object.prototype.hasOwnProperty.call(opts,"visible")?opts.visible:"hover",opts.placement=Object.prototype.hasOwnProperty.call(opts,"placement")?opts.placement:"right",opts.ariaLabel=Object.prototype.hasOwnProperty.call(opts,"ariaLabel")?opts.ariaLabel:"Anchor",opts.class=Object.prototype.hasOwnProperty.call(opts,"class")?opts.class:"",opts.base=Object.prototype.hasOwnProperty.call(opts,"base")?opts.base:"",opts.truncate=Object.prototype.hasOwnProperty.call(opts,"truncate")?Math.floor(opts.truncate):64,opts.titleText=Object.prototype.hasOwnProperty.call(opts,"titleText")?opts.titleText:""}function _getElements(input){var elements;if("string"==typeof input||input instanceof String)elements=[].slice.call(document.querySelectorAll(input));else{if(!(Array.isArray(input)||input instanceof NodeList))throw new TypeError("The selector provided to AnchorJS was invalid.");elements=[].slice.call(input)}return elements}this.options=options||{},this.elements=[],_applyRemainingDefaultOptions(this.options),this.isTouchDevice=function(){return Boolean("ontouchstart"in window||window.TouchEvent||window.DocumentTouch&&document instanceof DocumentTouch)},this.add=function(firstStyleEl){var elements,idList,elementID,i,index,count,tidyText,newTidyText,anchor,visibleOptionToUse,hrefBase,elsWithIds,indexesToDrop=[];if(_applyRemainingDefaultOptions(this.options),"touch"===(visibleOptionToUse=this.options.visible)&&(visibleOptionToUse=this.isTouchDevice()?"always":"hover"),0===(elements=_getElements(firstStyleEl=firstStyleEl||"h2, h3, h4, h5, h6")).length)return this;for(null===document.head.querySelector("style.anchorjs")&&((elsWithIds=document.createElement("style")).className="anchorjs",elsWithIds.appendChild(document.createTextNode("")),void 0===(firstStyleEl=document.head.querySelector('[rel="stylesheet"],style'))?document.head.appendChild(elsWithIds):document.head.insertBefore(elsWithIds,firstStyleEl),elsWithIds.sheet.insertRule(".anchorjs-link{opacity:0;text-decoration:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}",elsWithIds.sheet.cssRules.length),elsWithIds.sheet.insertRule(":hover>.anchorjs-link,.anchorjs-link:focus{opacity:1}",elsWithIds.sheet.cssRules.length),elsWithIds.sheet.insertRule("[data-anchorjs-icon]::after{content:attr(data-anchorjs-icon)}",elsWithIds.sheet.cssRules.length),elsWithIds.sheet.insertRule('@font-face{font-family:anchorjs-icons;src:url(data:n/a;base64,AAEAAAALAIAAAwAwT1MvMg8yG2cAAAE4AAAAYGNtYXDp3gC3AAABpAAAAExnYXNwAAAAEAAAA9wAAAAIZ2x5ZlQCcfwAAAH4AAABCGhlYWQHFvHyAAAAvAAAADZoaGVhBnACFwAAAPQAAAAkaG10eASAADEAAAGYAAAADGxvY2EACACEAAAB8AAAAAhtYXhwAAYAVwAAARgAAAAgbmFtZQGOH9cAAAMAAAAAunBvc3QAAwAAAAADvAAAACAAAQAAAAEAAHzE2p9fDzz1AAkEAAAAAADRecUWAAAAANQA6R8AAAAAAoACwAAAAAgAAgAAAAAAAAABAAADwP/AAAACgAAA/9MCrQABAAAAAAAAAAAAAAAAAAAAAwABAAAAAwBVAAIAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAMCQAGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAg//0DwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAAIAAAACgAAxAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADAAAAAIAAgAAgAAACDpy//9//8AAAAg6cv//f///+EWNwADAAEAAAAAAAAAAAAAAAAACACEAAEAAAAAAAAAAAAAAAAxAAACAAQARAKAAsAAKwBUAAABIiYnJjQ3NzY2MzIWFxYUBwcGIicmNDc3NjQnJiYjIgYHBwYUFxYUBwYGIwciJicmNDc3NjIXFhQHBwYUFxYWMzI2Nzc2NCcmNDc2MhcWFAcHBgYjARQGDAUtLXoWOR8fORYtLTgKGwoKCjgaGg0gEhIgDXoaGgkJBQwHdR85Fi0tOAobCgoKOBoaDSASEiANehoaCQkKGwotLXoWOR8BMwUFLYEuehYXFxYugC44CQkKGwo4GkoaDQ0NDXoaShoKGwoFBe8XFi6ALjgJCQobCjgaShoNDQ0NehpKGgobCgoKLYEuehYXAAAADACWAAEAAAAAAAEACAAAAAEAAAAAAAIAAwAIAAEAAAAAAAMACAAAAAEAAAAAAAQACAAAAAEAAAAAAAUAAQALAAEAAAAAAAYACAAAAAMAAQQJAAEAEAAMAAMAAQQJAAIABgAcAAMAAQQJAAMAEAAMAAMAAQQJAAQAEAAMAAMAAQQJAAUAAgAiAAMAAQQJAAYAEAAMYW5jaG9yanM0MDBAAGEAbgBjAGgAbwByAGoAcwA0ADAAMABAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAP) format("truetype")}',elsWithIds.sheet.cssRules.length)),elsWithIds=document.querySelectorAll("[id]"),idList=[].map.call(elsWithIds,function(el){return el.id}),i=0;i<elements.length;i++)if(this.hasAnchorJSLink(elements[i]))indexesToDrop.push(i);else{if(elements[i].hasAttribute("id"))elementID=elements[i].getAttribute("id");else if(elements[i].hasAttribute("data-anchor-id"))elementID=elements[i].getAttribute("data-anchor-id");else{for(newTidyText=tidyText=this.urlify(elements[i].textContent),count=0;index=idList.indexOf(newTidyText=void 0!==index?tidyText+"-"+count:newTidyText),count+=1,-1!==index;);index=void 0,idList.push(newTidyText),elements[i].setAttribute("id",newTidyText),elementID=newTidyText}(anchor=document.createElement("a")).className="anchorjs-link "+this.options.class,anchor.setAttribute("aria-label",this.options.ariaLabel),anchor.setAttribute("data-anchorjs-icon",this.options.icon),this.options.titleText&&(anchor.title=this.options.titleText),hrefBase=document.querySelector("base")?window.location.pathname+window.location.search:"",hrefBase=this.options.base||hrefBase,anchor.href=hrefBase+"#"+elementID,"always"===visibleOptionToUse&&(anchor.style.opacity="1"),""===this.options.icon&&(anchor.style.font="1em/1 anchorjs-icons","left"===this.options.placement&&(anchor.style.lineHeight="inherit")),"left"===this.options.placement?(anchor.style.position="absolute",anchor.style.marginLeft="-1em",anchor.style.paddingRight=".5em",elements[i].insertBefore(anchor,elements[i].firstChild)):(anchor.style.paddingLeft=".375em",elements[i].appendChild(anchor))}for(i=0;i<indexesToDrop.length;i++)elements.splice(indexesToDrop[i]-i,1);return this.elements=this.elements.concat(elements),this},this.remove=function(selector){for(var index,domAnchor,elements=_getElements(selector),i=0;i<elements.length;i++)(domAnchor=elements[i].querySelector(".anchorjs-link"))&&(-1!==(index=this.elements.indexOf(elements[i]))&&this.elements.splice(index,1),elements[i].removeChild(domAnchor));return this},this.removeAll=function(){this.remove(this.elements)},this.urlify=function(text){var textareaElement=document.createElement("textarea");textareaElement.innerHTML=text,text=textareaElement.value;return this.options.truncate||_applyRemainingDefaultOptions(this.options),text.trim().replace(/'/gi,"").replace(/[& +$,:;=?@"#{}|^~[`%!'<>\]./()*\\\n\t\b\v\u00A0]/g,"-").replace(/-{2,}/g,"-").substring(0,this.options.truncate).replace(/^-+|-+$/gm,"").toLowerCase()},this.hasAnchorJSLink=function(hasRightAnchor){var hasLeftAnchor=hasRightAnchor.firstChild&&-1<(" "+hasRightAnchor.firstChild.className+" ").indexOf(" anchorjs-link "),hasRightAnchor=hasRightAnchor.lastChild&&-1<(" "+hasRightAnchor.lastChild.className+" ").indexOf(" anchorjs-link ");return hasLeftAnchor||hasRightAnchor||!1}}});