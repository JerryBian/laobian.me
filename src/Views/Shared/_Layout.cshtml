@inject IOptions<SwanOption> _option
@inject IHostEnvironment _env
<!DOCTYPE html>
<html lang="zh">
<head>
    @{
        var buildOption = new HtmlHeadBuildOption
            {
                ApplicationTitleColor = "#2d89ef",
                Description = ViewData[Constants.ViewData.Description]?.ToString(),
                RobotsEnabled = bool.TryParse(ViewData[Constants.ViewData.RobotsEnabled]?.ToString(), out var result) ? result : _env.IsProduction() && !Context.IsAuthorized(),
                SafariPinnedTabColor = "#5bbad5",
                ThemeColor = "#ffffff",
                Title = ViewData[Constants.ViewData.Title]?.ToString(),
                BaseTitle = _option.Value.Title,
                BaseImage = $"{_option.Value.BaseUrl}/file/icon/android-chrome-512x512.png",
                Image = ViewData[Constants.ViewData.Image]?.ToString(),
                DatePublished = ViewData[Constants.ViewData.DatePublished] == null ? DateTime.Now : Convert.ToDateTime(ViewData[Constants.ViewData.DatePublished]),
                DateModified = ViewData[Constants.ViewData.DateModified] == null ? DateTime.Now : Convert.ToDateTime(ViewData[Constants.ViewData.DateModified])
            };

        var headerBuilder = new HtmlHeadBuilder(_option.Value, buildOption);
        @Html.Raw(headerBuilder.Build())
    }

    @if (Context.IsAuthorized())
    {
        <link href="~/admin.min.css" rel="stylesheet" asp-append-version="true" />
    }
    else
    {
        <link href="~/style.min.css" rel="stylesheet" asp-append-version="true" />
    }
</head>
<body class="d-flex min-vh-100 w-100 flex-column bg-white">
    <partial name="_Navbar" />
    <main class="container py-2 wrapper rounded">
        <div class="text-center my-4">
            @await RenderSectionAsync("Header", false)
        </div>
        @RenderBody()
    </main>
    <partial name="_Footer" />

    <div class="modal fade" id="modalDialog">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" id="modalDialogHeader"></div>
                <div class="modal-body" id="modalDialogBody"></div>
                <div class="modal-footer" id="modalDialogFooter"></div>
            </div>
        </div>
    </div>

    @if (Context.IsAuthorized())
    {
        <script src="~/admin.min.js" asp-append-version="true"></script>
    }
    else
    {
        <script src="~/script.min.js" asp-append-version="true"></script>
    }

    @await RenderSectionAsync("Script", false)
</body>
</html>